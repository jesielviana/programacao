{"componentChunkName":"component---src-templates-markdown-js","path":"/assignments/6","result":{"data":{"markdownRemark":{"html":"<p><strong>Due Date 10/24/18 11:59 PM</strong></p>\n<p>Download the implementation stub <a href=\"/~cis197/assignments/build/CIS197_HW6NEW.zip\">here</a>. You can also just use your previous homework if you  feel your implementation was correct</p>\n<p>Okay so for the last homework we ended up with  a  very lite version of piazza  that allowed users to sign up, log in, and submit questions. We did not have the ability to answer  questions, nor did we have the ability to see questions and answers come in \"live\" (i.e. we had to refresh the page in order to see  new content). For this assignment (also guided), we'll be showing you how to convert that old piazza to this new piazza!</p>\n<p><img src=\"https://media.giphy.com/media/euj9Jel3IAleIltOpM/giphy.gif\"></p>\n<p><img src=\"https://media.giphy.com/media/Ah2sCD8k9nLdfKCNIz/giphy.gif\"></p>\n<p>Wowee! How fun!</p>\n<p>What is unfortunately not demo'd here is the ability for answers to also live update if you are looking at a question :).</p>\n<p>So to cover our new feature set</p>\n<ul>\n<li>\"Live\" functionality for viewing new questions come in</li>\n<li>\"Live\" functionality for viewing new answers come in on a question we are looking at</li>\n<li>Ability to select question and see content/answers without doing page reload</li>\n<li>Ability to submit answer to question  without doing page reload</li>\n<li>Ability to add question without doing page reload</li>\n<li>New UI :)</li>\n</ul>\n<p>For those of you who understood the latter half of last lecture, we can achieve our \"live\" functionality with an AJAX call done on an interval. However, AJAX calls don't just GET information, they can also POST information, allowing us to send data to the server without needing to do a form submission. This \"shortcut\" can be pretty helpful for us to allow the user to avoid the need to do another page load. For all  the parts a user actually interacts with, they only need to send back and forth small changes to the server (and  nothing huge like a page render). Plus, it leads to a much more \"reactive\" UX that responds immediately to user input.</p>\n<h2>Table Of Contents:</h2>\n<ul>\n<li>\n<p>Model changes</p>\n<ul>\n<li>Question authorship</li>\n<li>Question answering</li>\n</ul>\n</li>\n<li>\n<p>API Routes</p>\n<ul>\n<li>get questions</li>\n<li>add question</li>\n<li>answer question</li>\n</ul>\n</li>\n<li>\n<p>Frontend changes</p>\n<ul>\n<li>POST question to server</li>\n<li>Live update question feed</li>\n<li>POST answer to server</li>\n<li>Live update currently viewed question</li>\n</ul>\n</li>\n</ul>\n<p>To clarify, this assignment doesn't have any tests. Once again, we are just looking for functionality. After this one, we'll be going back to tests again :(</p>\n<h3>Model Changes</h3>\n<p>So this will probably be the shortest part of the writeup. Since we're \"beefing up\" Piazza lite, we need to  add some features to the questions we ask. First off, our questions should show what author made the  question and they should also have a field that stores the answers to these questions.</p>\n<p><strong>TODO:</strong> In <code class=\"language-text\">models/question.js</code> add the appropriate fields <code class=\"language-text\">author</code> and <code class=\"language-text\">answer</code> to your <code class=\"language-text\">questionSchema</code>.</p>\n<p><strong>Setting a Question author</strong></p>\n<p>In the last assignment, we restricted question posting to only people who were signed in  (i.e. they had <code class=\"language-text\">req.session.user</code> equal to some non empty string of their username). In our POST route for <code class=\"language-text\">/</code> (that allows us to add a question), just as we create a new question, insert a property author of the new question equal to the <code class=\"language-text\">req.session.user</code> variable. So it'd be something like</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>\n    <span class=\"token keyword\">var</span> q <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Question</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> questionText<span class=\"token operator\">:</span> questionText<span class=\"token punctuation\">,</span> author<span class=\"token operator\">:</span> req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>user <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>A question for you to think about  is why does this work? what will <code class=\"language-text\">req.session.user</code> be equal to at this point?</p>\n<p>To actually see what the author property is set to, you can either pull out your handy-dandy Studio 3T MongoDB viewer, or you can just adjust your index.html template to output the <code class=\"language-text\">author</code> property of a question in addition to showing  the <code class=\"language-text\">questionText</code>.</p>\n<p><strong>TODO:</strong> make sure that your question model has author and answer properties and the author property is set on new questions</p>\n<p>We'll use this new model soon...</p>\n<h3>API Routes</h3>\n<p>In class, we covered the idea of an API route as a designated route on a server that deals with just sending back information from the user in the  form of JSON or some other easily parsably text. This  is especially useful for AJAX calls because they issue requests  to routes on your server and do something with what the route returns. As we saw in class, if we just do an AJAX call on the <code class=\"language-text\">/</code> route, we'll get back a string  that represents the html  of the rendered index.html page. Rather than trying to parse out relevant info (in class the Todos, here  the Questions), we can just  designate a route <code class=\"language-text\">/api/getQuestions</code> that just get's us all  the questions in a nice little JSON.</p>\n<p><strong>TODO:</strong> Create a file <code class=\"language-text\">routes/api.js</code> (i.e. a file under the <code class=\"language-text\">routes</code> folder called <code class=\"language-text\">api.js</code>) and put in the following stub implementation:</p>\n<p><strong>routes/api.js</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> router <span class=\"token operator\">=</span> express<span class=\"token punctuation\">.</span><span class=\"token function\">Router</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> Question <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../models/question.js'</span><span class=\"token punctuation\">)</span>\n\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/getQuestions'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/addQuestion'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/answerQuestion'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> router<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Since this is a set of routes that we want to be accessible under a <code class=\"language-text\">/api</code> prefix, go back to <code class=\"language-text\">server.js</code> really quick mount the API routes in this file under the  <code class=\"language-text\">/api</code> prefix (recall how we did that for the <code class=\"language-text\">/account</code> routes).</p>\n<p>In the <code class=\"language-text\">/getQuestions</code> route in this file, the name implies that  we would like to get  all of  the questions. We already do that in the GET of our <code class=\"language-text\">/</code> route, so just replicate the database call logic here. Instead of doing  a res.render('index') call at the end to send to the user, instead do <code class=\"language-text\">res.json(whateverResultsYouWantToReport)</code>.</p>\n<p>If you have mounted things correctly, you should be able to visit <code class=\"language-text\">localhost:3000/api/getQuestions</code> and see an array of questions be shown to you as follows (albeit slightly formatted)</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span><span class=\"token string\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"5bc583b52076db0015fb82a8\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"questionText\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"This is the application you'll be making.\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"author\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"suria@seas.upenn.edu\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"__v\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token punctuation\">{</span><span class=\"token string\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"5bc584702076db0015fb82a9\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"questionText\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"new question?          \"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"author\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"suria@seas.upenn.edu\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"__v\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token punctuation\">{</span><span class=\"token string\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"5bc584c82076db0015fb82aa\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"questionText\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"Add Question: \\n          \"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"author\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"suria@seas.upenn.edu\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"__v\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token punctuation\">{</span><span class=\"token string\">\"_id\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"5bc584db2076db0015fb82ab\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"questionText\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"yep sorry!\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"author\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"suria@seas.upenn.edu\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"__v\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p><strong>TODO:</strong> Implement getQuestions</p>\n<p><strong>addQuestion</strong></p>\n<p>Before we tackle the addQuestion route, we need to reason a bit about  how it will be used. This route will accept a AJAX POST request (i.e. there won't be a form submission, but rather a programmatic post request made to that route). Since this isn't a post route  that will accept form submissions, we need to tell bodyPaser (what we use to put post data on the <code class=\"language-text\">req.body</code> object) to also interpret data posted via AJAX (typically done in the form of JSON).</p>\n<p>To do this, go back to <code class=\"language-text\">server.js</code> and  put the following line under our <code class=\"language-text\">app.use(bodyParser.urlEncoded(...))</code> line:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>bodyParser<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>And that's it! you'll now be able to accept post data from AJAX requests.</p>\n<p>Now, replicate behavior that we did in our POST <code class=\"language-text\">/</code> route  (i.e. create a new question with an author). You'll still have access to  <code class=\"language-text\">req.session.user</code> even though this is an API route (AJAX automatically captures all user cookies and sends it along with each request). You can also assume that the questionText will be provided to you via <code class=\"language-text\">req.body.questionText</code>. If all is successful, just respond back to the user with <code class=\"language-text\">res.json({ status: &#39;OK&#39; })</code>.</p>\n<p>Now comes the question for how do we actually test that this route works. We can't type a url into our url bar since that actually initiates a GET request. We also haven't gotten to  the point where we can make changes to our frontend yet that would allow us to run an AJAX POST request. We need some way of programmatically sending a POST request so we can test our whether our API works.</p>\n<p>We can do this using curl. For those who are able to do so, here is the command:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">curl &#39;{&quot;questionText&quot;: &quot;question From Curl&quot;}&#39; -H &quot;Content-Type: application/json&quot; -X POST http://localhost:3000/api/addQuestion</code></pre></div>\n<p>For those who are visually inclined,  download the Postman app from <a href=\"https://www.getpostman.com/apps\">here</a> for your platform. Once you've signed up (don't worry it's totally free), and replicate the state of postman that is in the  image below and click \"SEND\". You  should see <code class=\"language-text\">{\n  &quot;status&quot;: &quot;OK&quot;\n}</code> pop up in the area below.</p>\n<p><img src=\"https://i.imgur.com/VjcYT1Z.png\"></p>\n<p>If you visit <code class=\"language-text\">localhost:3000/api/getQuestions</code> again, you should now see your new question at the bottom of the list.</p>\n<p>Oh all right...I'll give you the implementation of addQuestion as well :)</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">router<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/addQuestion'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> <span class=\"token punctuation\">{</span> questionText <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">;</span> <span class=\"token comment\">// ES6 shorthand</span>\n  <span class=\"token keyword\">var</span> author <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span>  q <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Question</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> questionText<span class=\"token punctuation\">,</span> author <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// ES6 shorthand</span>\n  q<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> result</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token function\">next</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> status<span class=\"token operator\">:</span> <span class=\"token string\">'OK'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>TODO:</strong> Implement addQuestions</p>\n<p><strong>answerQuestion</strong></p>\n<p>Okay, so now we want to add  in the functionality to add an answer to a question via an API route (basically this will be in place so people can answer a question). In order to answer a question, we have to know the answer  and the question  we are answering. Let's specify that our API route takes the following paramter json object:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">{ answer:  &quot;some string of  an answer here&quot;,\n  qid: &quot;the _id of the question that&#39;s being answered&quot;\n}</code></pre></div>\n<p>We will be able to access both of these properties on the <code class=\"language-text\">req.body</code> object as was the case with <code class=\"language-text\">/api/addQuestion</code>.</p>\n<p>From here, you should be able to implement the route, but just to  give you a bit of the database querying and editing part, you will have to find a question by an id, edit the question (to set the  new answer) and then save that question.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">Question<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>whateverIdYouGetFromThePost<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> question</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    question<span class=\"token punctuation\">.</span>answer <span class=\"token operator\">=</span> whateverAnswerYouGetFromThePost<span class=\"token punctuation\">;</span>\n    question<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">saveErr<span class=\"token punctuation\">,</span> result</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>If all is successful, respond with <code class=\"language-text\">{ success: &#39;OK&#39; }</code>.</p>\n<p>To test this, we need to find a question <code class=\"language-text\">_id</code> to modify (where might we easily access a list of questions to look hmm...) and edit our Postman request URL and body parameters accordingly. If we revisit <code class=\"language-text\">/api/getQuestions</code> you should be able to see the question you added an answer to actually have an answer property now.</p>\n<p><strong>TODO:</strong> Implement answerQuestion</p>\n<h3>Frontend</h3>\n<h4>Housekeeping and new files:</h4>\n<p><strong>OLD HOMEWORK ONLY</strong>: Replace your index.html with the following file (if you are doing this assignment prior to the release of the code zip of HW5).</p>\n<p><a href=\"https://gist.github.com/abhisuri97/5eadf5eb87a5faeaaacc3004a9232a9f\">https://gist.github.com/abhisuri97/5eadf5eb87a5faeaaacc3004a9232a9f</a></p>\n<p><strong>OLD HOMEWORK ONLY</strong>: Create a new folder called <code class=\"language-text\">static</code> at the top level and two subfolders in it called <code class=\"language-text\">scripts</code> and <code class=\"language-text\">styles</code>. In the scripts folder, put in the following file (name it <code class=\"language-text\">main.js</code>)</p>\n<p><a href=\"https://gist.github.com/abhisuri97/a3bbe652625995a6a0a63a74850ff7d2\">https://gist.github.com/abhisuri97/a3bbe652625995a6a0a63a74850ff7d2</a></p>\n<p><strong>FOR EVERYONE</strong>: In the <code class=\"language-text\">scripts</code> folder, create another subfolder called <code class=\"language-text\">lib</code> and save the code from <a href=\"https://code.jquery.com/jquery-3.3.1.min.js\">here</a> under the name  <code class=\"language-text\">jquery.min.js</code> within that <code class=\"language-text\">lib</code> folder.</p>\n<p><strong>OLD HOMEWORK ONLY</strong>: In the styles folder, create a new file called <code class=\"language-text\">styles.css</code> with the content from here:</p>\n<p><a href=\"https://gist.github.com/abhisuri97/b5acabff8f6db5d7d35fc01f63949df8\">https://gist.github.com/abhisuri97/b5acabff8f6db5d7d35fc01f63949df8</a></p>\n<p><strong>FOR EVERYONE</strong>: Lastly, as will be shown in class, we need to let express know that some urls are meant just to load up static assets. Back in <code class=\"language-text\">server.js</code> put in the following line before  any routes are declared.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/static'</span><span class=\"token punctuation\">,</span> express<span class=\"token punctuation\">.</span><span class=\"token function\">static</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'static'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>** EVERYONE FROM HERE ON OUT: **</p>\n<p>Now, if you visit <code class=\"language-text\">localhost:3000</code> you should see a fancier version of  what you originally had. Check the chrome console to see if you have any 404 errors  (and post on piazza if you do see any). You should see something like the following.</p>\n<p><img src=\"https://i.imgur.com/7zpBqed.png\"></p>\n<h4>Adding a Question on the frontend</h4>\n<p>If you click 'Add new  Question +', you should be greeted with a modal:</p>\n<p><img src=\"https://i.imgur.com/d0qtMGM.png\"></p>\n<p>This logic of clicking the \"Add new question +\" button and displaying the modal (i.e. changing its css style property from <code class=\"language-text\">display:none</code> to <code class=\"language-text\">display:block</code>) is done on lines 56-64 of <code class=\"language-text\">main.js</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  <span class=\"token comment\">// when we want to make a new question, show the modal</span>\n  <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#new-question'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.modal'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">css</span><span class=\"token punctuation\">(</span><span class=\"token string\">'display'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'block'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n\n  <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#close-modal'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.modal'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">css</span><span class=\"token punctuation\">(</span><span class=\"token string\">'display'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'none'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Take a look through the <code class=\"language-text\">index.html</code> structure to see what exactly all the jQuery elements are referring to.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>main-body<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>left-col<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      &lt;% if (user) { %> <span class=\"token comment\">&lt;!-- I.e. show the following if someone is logged in --></span>\n      <span class=\"token comment\">&lt;!-- relevant part --></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>btn<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>new-question<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Add new Question + <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>modal<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span>none</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>question-area<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n          <span class=\"token comment\">&lt;!-- this is the input box --></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>textarea</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>question-text<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n          Add Question:\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>textarea</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>btn<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>submit-question<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Submit Question<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>btn<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>close-modal<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Close<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Now we want to actually be able to add a new question. But why is this different than our original idea of having a form? Well...right now it isn't too different, but we're going to be driving home the idea of using an AJAX request to communicate information to the server via an API route rather than setting up a typical post route. Here, once we click on the \"Submit question\" button in our modal, we still get to stay on the page. Beforehand, we actually reload the entire page. This will be motivated later on as we add in the ability to instantaneously  see the  new question appear at the bottom of our list live.</p>\n<p>So now, let's actually code up the stuff that happens on click of the Submit Question button. We've provided a short function stub in <code class=\"language-text\">main.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#submit-question'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> qText <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#question-text'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// TODO: make a post request to /api/addQuestion with the qText as the</span>\n    <span class=\"token comment\">// questionText attribute. On success, hide the modal</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>This function basically says, when we click on the submit button function, grab the text from the textbox and store it in qText. Now we need to implement the AJAX post logic to our server's API route for handling adding a new question. That's  the <code class=\"language-text\">/api/addQuestion</code> route. To make an ajax post request, we need to specify <code class=\"language-text\">url</code>, <code class=\"language-text\">type</code>, <code class=\"language-text\">data</code>, and <code class=\"language-text\">success</code> properties of the object passed into the <code class=\"language-text\">$.ajax(...)</code> function.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">    $<span class=\"token punctuation\">.</span><span class=\"token function\">ajax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      url<span class=\"token operator\">:</span> <span class=\"token string\">'/api/addQuestion'</span><span class=\"token punctuation\">,</span>\n      data<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> questionText<span class=\"token operator\">:</span> qText <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      type<span class=\"token operator\">:</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// exercise for you: close the modal (hint: see how we do it in other places)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>The code here is fairly self explanatory. The only thing left for you to do here is to put in the code within our success function to hide the modal.</p>\n<p>But now, if  we test out this function, we don't get to actually see our new question get added to our list. However, if we go to <code class=\"language-text\">localhost:3000/api/getQuestions</code> we  actually do see it  there. Hmm. There are a couple of ways that we could handle adding the new question to the list</p>\n<p><strong>Way  1:</strong> in the <code class=\"language-text\">success</code> method of  the above AJAX post, insert a new element into  the list.</p>\n<p><strong>Way 2:</strong> Have a running interval in the background that checks the <code class=\"language-text\">/api/getQuestions</code> route ever 2.5 seconds and updates the list of questions that way. If we submit a  question, it'll show up in the list with delay at maximum of 2.5 seconds.</p>\n<p>Way 2 does present us with multiple advantages since we  kinda kill two birds with one stone (i.e. we can insert our new question into the list <em>and</em> we can update our list with  new  questions that other users submit).</p>\n<h4>Getting new questions</h4>\n<p>In the <code class=\"language-text\">main.js</code> file, find the method stub <code class=\"language-text\">getQuestions()</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  <span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// ...other stuff</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">getQuestions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// TODO: make an ajax request to /api/getQuestions. on success</span>\n    <span class=\"token comment\">//       set  the data variable equal to the response and render</span>\n    <span class=\"token comment\">//       out the question previews (by callingrenderPreviews())</span>\n    <span class=\"token comment\">//       Later on in the writeup, also render the active question</span>\n    <span class=\"token comment\">//       (to update it) with renderactive()</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>TODO: Just as we did in class, make an ajax request of type <code class=\"language-text\">GET</code> to  the <code class=\"language-text\">/api/getQuestions</code> route. On success, set the  <code class=\"language-text\">data</code> variable equal to the response (this is so we can keep track of the questions and use them in other methods to do things  to the questions). Also call the  <code class=\"language-text\">renderPreviews()</code> method when you are done.</p>\n<p>Note that the renderPreviews method (below) relies on the data variable being set properly so we can add the list elements to our list of questions.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  <span class=\"token keyword\">function</span> <span class=\"token function\">renderPreviews</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#questions'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span>\n        data<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">'&lt;li data-qid=\"'</span> <span class=\"token operator\">+</span> i<span class=\"token punctuation\">.</span>_id <span class=\"token operator\">+</span> <span class=\"token string\">'\">'</span> <span class=\"token operator\">+</span> i<span class=\"token punctuation\">.</span>questionText <span class=\"token operator\">+</span> <span class=\"token string\">'&lt;/li>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>Note</strong> for each question we make, we give it a data property qid equal to its question id. Will be useful in the next section!</p>\n<p>So <em>now</em> if you add a question, you should see it pop up in the list! Similarly, if another user session adds a question, you'll be able to see it pop up for you as well without refreshing the page. Wow!</p>\n<p><img src=\"https://media.giphy.com/media/8lZ0r0XQkwnIiJy0Cw/giphy.gif\"></p>\n<h4>Showing a Question</h4>\n<p>We have provided for you a wonderful method that inserts a question's info into the right pane of our website.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  <span class=\"token keyword\">function</span> <span class=\"token function\">renderActive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>activeIdx <span class=\"token operator\">></span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> active <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span>activeIdx<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#show-question'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">css</span><span class=\"token punctuation\">(</span><span class=\"token string\">'display'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'block'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#question'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span>active<span class=\"token punctuation\">.</span>questionText <span class=\"token operator\">?</span> active<span class=\"token punctuation\">.</span>questionText<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#author'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span>active<span class=\"token punctuation\">.</span>author <span class=\"token operator\">?</span> active<span class=\"token punctuation\">.</span>author<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#answer-text'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span>active<span class=\"token punctuation\">.</span>answer <span class=\"token operator\">?</span> active<span class=\"token punctuation\">.</span>answer <span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#show-question'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">css</span><span class=\"token punctuation\">(</span><span class=\"token string\">'display'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'none'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>Look through this method and the html to figure out  what's going  on.</p>\n<p>Note that this method relies on two variables <code class=\"language-text\">activeIdx</code> and <code class=\"language-text\">data</code>. <code class=\"language-text\">data</code>  is set on every API call to <code class=\"language-text\">/api/getQuestions</code>. <code class=\"language-text\">activeIdx</code> is what we will set in this next question. But first some motivation:</p>\n<p>Let's  say we click on a  question. The ideal flow is that we get the id of that question and then figure out where in our array of data that question lies and we just  would <em>normally</em> store the <em>value</em> at that array index. However, since we are dealing with data that changes, it is very possible that  our question could change while we are looking at it. By storing  only the index of the active question and  getting the  question information from our data array each time we call renderActive(), we can ensure that the  new data of the question will actually render out. This will be more relevant in the next part.</p>\n<p>So, when we implement the following stub:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#questions'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'li'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// TODO: When a question is clicked, set the `active` variable equal to</span>\n    <span class=\"token comment\">//       the data of the question that is active (hint: look through the</span>\n    <span class=\"token comment\">//       data array. If an array entry has the same _id as the _id we just</span>\n    <span class=\"token comment\">//       declared here, it is the active question</span>\n\n    <span class=\"token comment\">// we now render out the active question</span>\n    <span class=\"token function\">renderActive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>We need to do a few things.</p>\n<ul>\n<li>get the <code class=\"language-text\">_id</code> of the question we have clicked on (hint, look up how to access the <code class=\"language-text\">data-qid</code> attribute we've set  for you</li>\n<li>look through  the <code class=\"language-text\">data</code> array for any question <code class=\"language-text\">_id</code> that matches the <code class=\"language-text\">_id</code> we just found</li>\n<li>Once we've found that, set <code class=\"language-text\">activeIdx</code> equal to that index.</li>\n</ul>\n<p>Note, this  method implementation can be done in 1 line of a jQuery call and a for loop (or <code class=\"language-text\">.forEach</code> call if you're fancy).</p>\n<p>At the end of  the method, we call <code class=\"language-text\">renderActive()</code>. So if we implement everything and click on a question, it should mimic the following behavior:</p>\n<p><img src=\"https://media.giphy.com/media/lpeE65dnn1OZYY6Npf/giphy.gif\"></p>\n<p>Make sure this also works for new questions that you insert into the list!</p>\n<h4>Adding Answers</h4>\n<p>Almost done...</p>\n<p>Now, we have a bit of a  tall feature request here:</p>\n<ul>\n<li>We want to answer these questions (that's fine)</li>\n<li>But if we are on a question and someone else answers, we should be able to see the answer that is displayed change as well.</li>\n<li>Also, when we submit, we should also see our answer pop up.</li>\n</ul>\n<p>Okay. So the relevant part to implement here is the following method:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#show-question'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#submitAnswer'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> answer <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#answer'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// TODO: When we submit a new answer, send a POST request to</span>\n    <span class=\"token comment\">//      /api/answerQuestion with  the question answer and the active question's</span>\n    <span class=\"token comment\">//      _id.</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Okay, so we've sent an Ajax POST  request before, so that's fine (ref <code class=\"language-text\">/api/addQuestion</code> AJAX request). But now recall that our <code class=\"language-text\">/api/answerQuestion</code> api route needs a question <code class=\"language-text\">_id</code> to figure out what question it needs to add the given answer to. We already give you an <code class=\"language-text\">answer</code> variable that contains the actual value of our <code class=\"language-text\">#answer</code> textbox.</p>\n<p>But now we need to find out what is the active question's Id. Hmm...Perhaps it'll be <code class=\"language-text\">data[activeIdx]._id</code>. Yeah...that'd do it :)</p>\n<p>So TODO Here:</p>\n<ul>\n<li>Make an AJAX post  request to the <code class=\"language-text\">/api/answerQuestion</code> url with the data object containing keys answer and <code class=\"language-text\">qid</code> (or whatever you used to refer to your question <code class=\"language-text\">_id</code>).</li>\n<li>On success, don't do anything except console.log whatever response you get.</li>\n</ul>\n<p>Okay great, we added  an  answer...but that didn't do anything. In order to actually see the new answer pop up, I need to click on the question again after 2.5 s have elapsed and then i'll get the updated answer. Why is this?</p>\n<p>Well...it's because we have no way of getting updated info  on our questions other than the 2.5s interval we have on getting all the questions from <code class=\"language-text\">/api/getQuestions</code> (which in turn will update the <code class=\"language-text\">data</code> array).</p>\n<p>We know that the <code class=\"language-text\">renderActive()</code> method will re-look up the question corresponding to the activeIdx. Perhaps it'd be best to call  <code class=\"language-text\">renderActive()</code> every couple of seconds...perhaps every 2.5 seconds!</p>\n<p>Edit the <code class=\"language-text\">getQuestions()</code> method AJAX call to be the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">    $<span class=\"token punctuation\">.</span><span class=\"token function\">ajax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      url<span class=\"token operator\">:</span> <span class=\"token string\">'/api/getQuestions'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        data <span class=\"token operator\">=</span> res<span class=\"token punctuation\">;</span>\n        <span class=\"token function\">renderPreviews</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">renderActive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>That way we constantly update the active question! We should get the following behavior:</p>\n<p><img src=\"https://media.giphy.com/media/ja2qFAk1DFhUxm8yQp/giphy.gif\"></p>\n<h2>Heroku &#x26; Submission</h2>\n<p>Same instructions as last time. But this time, you should try and figure out what files should be added to your git repo and how they should be added :) Contact us over piazza if you have any issues.</p>\n<p>Also make sure that you make a file  <code class=\"language-text\">heroku_url.txt</code> with the actual link to your heroku app (it can be the same as last time or different, but we need to know).</p>\n<p><strong>NOTE: You should move the contents of your directory to a new folder and create a new heroku url, NOT the same one as hw5. If  you need help reverting see <a href=\"https://piazza.com/class/jlfyr4fho1j3rb?cid=294\">@294</a> on piazza.</strong></p>\n<h3>Gradescope Submission</h3>\n<p>The submission for Gradescope is open. Create a zip file using  the following command (or just zipping the following):</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">zip -r submission.zip middlewares/* package.json server.js views/* heroku_url.txt models/* routes/* static/*</code></pre></div>\n<h3>Rubric</h3>\n<ul>\n<li>/api/getQuestions route does return list of  questions [5pts]</li>\n<li>Questions made in another browser window will reflect automatically on another user's browser without page reload [5pts]</li>\n<li>The UI looks  the same as in examples (set up static dir correctly) [2pts]</li>\n<li>Ability to add question exists w/o page reload exists [5pts]</li>\n<li>Ability to add answer exists w/o page reload [5pts]</li>\n<li>ABility to see answer update in real time w/o page reload exists [3pts]</li>\n</ul>","frontmatter":{"date":"January 29, 2019","path":"/assignments/6","title":"Homework 6: Piazza Lite Part 2","metaTitle":null}}},"pageContext":{}}}